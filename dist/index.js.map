{"version":3,"file":"index.js","sources":["../src/babel.js","../src/webpack.js","../src/index.js"],"sourcesContent":["import {map} from 'lodash'\r\nimport {addBabelPlugin, addBabelPreset, addExternalBabelPlugin} from 'customize-cra'\r\n\r\nexport const addBabelPlugins = plugins => config => map(plugins, v => addBabelPlugin(v)(config))\r\nexport const addBabelPresets = presets => config => map(presets, v => addBabelPreset(v)(config))\r\nexport const addExternalBabelPlugins = plugins => config => map(plugins, v => addExternalBabelPlugin(v)(config))\r\n\r\nexport const addDefaultBabel = () => config => {\r\n    addBabelPresets([\r\n        '@emotion/babel-preset-css-prop'\r\n    ])(config)\r\n\r\n    addBabelPlugins([\r\n        'babel-plugin-lodash',\r\n        'date-fns',\r\n        ['babel-plugin-styled-components']\r\n    ])(config)\r\n\r\n    addExternalBabelPlugin (['@babel/plugin-transform-react-jsx'])(config)\r\n}\r\n","export const addProgressBar = (options = {}) => config => {\r\n    const ProgressBarPlugin = require('progress-bar-webpack-plugin');\r\n\r\n    config.plugins.push(new ProgressBarPlugin(options));\r\n\r\n    return config;\r\n};\r\n\r\nexport const addDuplicatePackageChecker = (options = {}) => config => {\r\n    const DuplicatePackageCheckerPlugin = require('duplicate-package-checker-webpack-plugin')\r\n\r\n    config.plugins.push(new DuplicatePackageCheckerPlugin(options));\r\n\r\n    return config;\r\n};\r\n\r\nexport const addBuildNotifier = (options = {\r\n    title: \"Your Project\",\r\n    suppressSuccess: true,\r\n}) => config => {\r\n    const WebpackBuildNotifierPlugin = require('webpack-build-notifier');\r\n\r\n    config.plugins = (config.plugins || []).concat([new WebpackBuildNotifierPlugin(options)])\r\n\r\n    return config;\r\n};\r\n\r\nexport const disableMinify = (options = {}) => config => {\r\n    const {minifyJS = true, minifyCSS = true, minifyHTML = true} = options\r\n\r\n    if(!minifyCSS) {\r\n        config.optimization.minimizer = config.optimization.minimizer.filter(\r\n            p => p.constructor.name !== \"OptimizeCssAssetsWebpackPlugin\"\r\n        )\r\n    }\r\n\r\n    if(!minifyJS) {\r\n        config.optimization.minimizer = config.optimization.minimizer.filter(\r\n            p => p.constructor.name !== \"TerserPlugin\"\r\n        )\r\n    }\r\n\r\n\r\n    if(!minifyHTML) {\r\n        config.plugins.map((p, k) => {\r\n            if(p.constructor.name === 'HtmlWebpackPlugin'){\r\n                config.plugins[k].options.minify = minifyHTML\r\n            }\r\n        })\r\n    }\r\n\r\n    return config\r\n}\r\n\r\nexport const disableFileHashes = () => config => {\r\n    const walk = obj => {\r\n        const paths = {\r\n            object: k => walk(obj[k]),\r\n            string: k => {\r\n                obj[k] = obj[k].replace(/\\[\\w*?hash:\\d+\\]\\./, '');\r\n            },\r\n        };\r\n        if (obj != null) {\r\n            Object.keys(obj)\r\n                .filter(k => paths[typeof obj[k]])\r\n                .forEach(k => paths[typeof obj[k]](k));\r\n        }\r\n    };\r\n\r\n    walk(config)\r\n\r\n    return config\r\n}\r\n","/*\r\n* https://github.com/osdevisnot/react-app-rewire-contrib/blob/master/packages/react-app-rewire-emotion/index.js\r\n* https://github.com/withspectrum/react-app-rewire-styled-components\r\n* https://github.com/stk-dmitry/react-app-rewire-date-fns\r\n* https://github.com/lwd-technology/react-app-rewire-provide-plugin\r\n* https://github.com/byzyk/react-app-rewire-webpack-bundle-analyzer\r\n* https://github.com/hsz/react-app-rewire-yaml\r\n* https://github.com/osdevisnot/react-app-rewire-contrib/tree/master/packages/react-app-rewire-react-library\r\n* https://github.com/andriijas/react-app-rewire-vendor-splitting\r\n* https://github.com/cdharris/react-app-rewire-hot-loader\r\n* https://github.com/oklas/react-app-rewire-alias\r\n* */\r\n\r\n\r\n/*\r\n* https://github.com/webpack/webpack/tree/master/examples\r\n* https://github.com/1337programming/webpack-shell-plugin\r\n* https://github.com/webpack-contrib/npm-install-webpack-plugin\r\n* https://github.com/survivejs/webpack-merge\r\n*/\r\n\r\nimport {addBabelPlugin, addBabelPreset, addBundleVisualizer, addExternalBabelPlugin} from 'customize-cra'\r\nimport {addDefaultBabel} from './babel';\r\nimport {addReactRefresh} from 'customize-cra-react-refresh'\r\nimport {addProgressBar, disableMinify} from './webpack'\r\n\r\nexport const rewireBuildBase = (options) = (config, env) => {\r\n    addDefaultBabel()(config)\r\n\r\n    addProgressBar()(config)\r\n\r\n    if(env === 'development') addReactRefresh()(config)\r\n    if(env === 'production') {\r\n        addBundleVisualizer()(config)\r\n        disableMinify({\r\n            minifyHTML: false,\r\n        })(config)\r\n    }\r\n}\r\n\r\nexport * from './babel'\r\nexport * from './webpack'\r\n\r\nexport {\r\n    addReactRefresh\r\n}\r\n\r\nexport {alias} from 'react-app-rewire-alias'\r\n\r\nexport {\r\n    addBabelPlugin,\r\n    addBabelPreset,\r\n    addBundleVisualizer,\r\n    addDecoratorsLegacy,\r\n    addExternalBabelPlugin,\r\n    addLessLoader,\r\n    addPostcssPlugins,\r\n    addTslintLoader,\r\n    addWebpackAlias,\r\n    addWebpackExternals,\r\n    addWebpackModuleRule,\r\n    addWebpackPlugin,\r\n    addWebpackResolve,\r\n    adjustStyleLoaders,\r\n    adjustWorkbox,\r\n    babelExclude,\r\n    babelInclude,\r\n    disableChunk,\r\n    disableEsLint,\r\n    enableEslintTypescript,\r\n    fixBabelImports,\r\n    getBabelLoader,\r\n    override,\r\n    overrideDevServer,\r\n    removeInternalBabelPlugin,\r\n    removeModuleScopePlugin,\r\n    setWebpackOptimizationSplitChunks,\r\n    setWebpackPublicPath,\r\n    setWebpackStats,\r\n    setWebpackTarget,\r\n    tap,\r\n    useBabelRc,\r\n    useEslintRc,\r\n    watchAll,\r\n} from 'customize-cra'\r\n\r\n\r\n\r\n"],"names":["addBabelPlugins","plugins","config","map","v","addBabelPlugin","addBabelPresets","presets","addBabelPreset","addExternalBabelPlugins","addExternalBabelPlugin","addDefaultBabel","addProgressBar","options","ProgressBarPlugin","require","push","addDuplicatePackageChecker","DuplicatePackageCheckerPlugin","addBuildNotifier","title","suppressSuccess","WebpackBuildNotifierPlugin","concat","disableMinify","minifyJS","minifyCSS","minifyHTML","optimization","minimizer","filter","p","constructor","name","k","minify","disableFileHashes","walk","obj","paths","object","string","replace","Object","keys","forEach","rewireBuildBase","env","addReactRefresh","addBundleVisualizer"],"mappings":"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"}